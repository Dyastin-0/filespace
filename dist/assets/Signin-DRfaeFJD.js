import{r as t,u as C,a as I,b as D,c as F,d as G,j as e,L as u,B as j,e as L}from"./index-BKNLTqy2.js";import{S as R}from"./ShowPassword-DKbuD3M6.js";import{I as S}from"./Input-GOd7nCC5.js";import{S as T}from"./Separator-DAJ-hYCC.js";import{f as $}from"./index-Dhn6iWR9.js";const q=({})=>{var w;const d=t.useRef(null),i=C(),v=I(),[f,m]=t.useState(!1),{setToken:p,setUser:x,token:h}=D(),{toastInfo:l}=F(),b=((w=v.state)==null?void 0:w.from)||"/home",[o,N]=G();t.useEffect(()=>{const s=o.get("token"),r=JSON.parse(o.get("user"));o.get("gae")&&(l("Google authentication error. Email is already used."),N({})),s&&r&&(p(s),x(r),i("/home"))},[o]),t.useEffect(()=>{d.current.focus()},[]),t.useEffect(()=>{h&&i("/home")},[h]);const[a,c]=t.useState({email:"",password:""}),[g,k]=t.useState(!1),P=async s=>{s.preventDefault();const{email:r,password:y}=a;m(!0);try{const{data:n}=await L.post("/auth",{email:r,password:y});p(n.accessToken),x(n.User),l("Signed in!"),c({email:"",password:""}),i(b)}catch(n){const E=n.response.data;l(`${E}`)}finally{m(!1)}};return e.jsxs("form",{className:"flex flex-col w-[250px] max-w-full p-4 text-xs text-primary-foreground rounded-md border border-secondary-accent z-10",onSubmit:P,children:[e.jsx("h2",{className:"w-full text-center pb-4 text-lg font-bold",children:"Sign in to Filespace"}),e.jsx(S,{required:!0,type:"email",placeholder:"Email",id:"email",ref:d,value:a.email,onChange:s=>c({...a,email:s.target.value})}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{autoComplete:"current-password",required:!0,type:g?"text":"password",placeholder:"Password",id:"password",onChange:s=>c({...a,password:s.target.value}),value:a.password}),a.password&&e.jsx(R,{showPassword:g,setShowPassword:k})]}),e.jsxs(u,{to:"/auth/recovery",className:"pb-2 w-fit outline-none text-primary-foreground text-xs focus:text-primary-highlight focus:underline",children:[" ","Forgot password?"," "]}),e.jsx(j,{type:"submit",disabled:f,text:`${f?"Signing in...":"Sign in"}`}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsx(T,{}),e.jsx("p",{className:"text-center text-xs",children:"Or sign in with"}),e.jsx(j,{text:"Google",icon:$,onClick:s=>{s.preventDefault(),window.location.href="https://filespace.dyastin.dev/api/v2/auth/google"}})]}),e.jsxs(u,{to:"/auth/verification",className:"self-center w-fit pt-2 outline-none text-primary-foreground text-xs transition-colors duration-300 focus:text-primary-highlight focus:underline",children:[" ","Verify your account"," "]}),e.jsxs(u,{to:"/sign-up",className:"self-center w-fit pt-2 outline-none text-primary-foreground text-xs transition-colors duration-300 focus:text-primary-highlight focus:underline",children:[" ","Don't have an account? click here"," "]})]})},J=()=>e.jsx("div",{className:"flex flex-col justify-center items-center w-full h-full bg-primary text-xs p-4 rounded-md",children:e.jsx(q,{})});export{J as default};
