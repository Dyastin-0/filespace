import{u as q,b as B,r as a,c as G,j as s,B as v,L as R,e as T}from"./index-BKNLTqy2.js";import{I as l}from"./Input-GOd7nCC5.js";import{P as A}from"./ProgressBar-BmsTvvgm.js";import{S}from"./ShowPassword-DKbuD3M6.js";import{t as D,a as j,b as L}from"./regex-Bon46KuK.js";import{S as F}from"./Separator-DAJ-hYCC.js";import{f as M}from"./index-Dhn6iWR9.js";const O=()=>{const c=q(),{setToken:y,setUser:P,token:m}=B(),p=a.useRef(null),{toastError:r,toastInfo:C}=G(),[e,n]=a.useState({username:"",email:"",password:""}),[o,f]=a.useState(""),[d,b]=a.useState(!1),[u,N]=a.useState({strength:0,color:"red",message:"Very weak"}),[w,_]=a.useState(!1),[x,k]=a.useState(!1),[h,g]=a.useState(!1);a.useEffect(()=>{m&&c("/home")},[m]),a.useEffect(()=>{b(o===e.password)},[o,e.password]),a.useEffect(()=>{p.current.focus()},[]),a.useEffect(()=>{e.password&&N(D(e.password))},[e.password]);const E=async t=>{t.preventDefault();const{username:I,email:U,password:$}=e;if(!L(e.username))return r("Invalid username.");if(!j(e.email))return r("Invalid email format.");if(u.strength<25)return r("Password should at least be 'Good.'");if(!d)return r("Passwords do not match.");g(!0);try{const{data:i}=await T.post("/auth/sign-up",{username:I,email:U,password:$});y(i.accessToken),P(i.user),n({username:"",email:"",password:""}),f(""),C("Sign up success! Check your email for the verification link."),c("/sign-in",{state:{from:"/sign-up"}})}catch(i){r(i.response.data)}finally{g(!1)}};return s.jsxs("form",{className:"flex flex-col w-[250px] max-w-full p-4 text-xs text-primary-foreground border border-secondary-accent rounded-md",onSubmit:E,children:[s.jsx("h2",{className:"w-full text-center pb-4 text-lg font-bold",children:"Create your account"}),s.jsx(l,{ref:p,placeholder:"Username",required:!0,id:"username",type:"text",autoComplete:"off",value:e.username,onChange:t=>n({...e,username:t.target.value})}),s.jsx(l,{placeholder:"Email",id:"email",required:!0,type:"email",autoComplete:"on",className:`${!j(e.email)&&e.email!==""?"shadow-[0px_2px_0_0] shadow-error":""}`,value:e.email,onChange:t=>n({...e,email:t.target.value})}),s.jsxs("div",{className:"relative",children:[s.jsx(l,{autoComplete:"current-password",placeholder:"Password",required:!0,id:"password",type:w?"text":"password",value:e.password,className:`${!d&&e.password?"shadow-[2px_2px_0_0] shadow-error":""}`,onChange:t=>n({...e,password:t.target.value})}),e.password&&s.jsx(S,{showPassword:w,setShowPassword:_})]}),s.jsx(A,{value:u.strength,text:u.message,visible:e.password}),s.jsxs("div",{className:"relative",children:[s.jsx(l,{autoComplete:"current-password",placeholder:"Confirm password",required:!0,id:"confirm_password",type:x?"text":"password",value:o,className:`${!d&&o?"shadow-[2px_2px_0_0] shadow-error":""}`,onChange:t=>f(t.target.value)}),o&&s.jsx(S,{showPassword:x,setShowPassword:k})]}),s.jsx(v,{type:"submit",disabled:h,text:`${h?"Signing up...":"Sign up"}`}),s.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[s.jsx(F,{}),s.jsx("p",{className:"text-center text-xs",children:"Or sign up with"}),s.jsx(v,{text:"Google",icon:M,onClick:t=>{t.preventDefault(),window.location.href="https://filespace.dyastin.dev/api/v2/auth/google"}})]}),s.jsxs(R,{to:"/sign-in",className:"self-center w-fit pt-2 outline-none text-primary-foreground text-xs transition-colors duration-300 focus:text-primary-highlight focus:underline",children:[" ","Already have an account? click here."," "]})]})},X=()=>s.jsx("div",{className:"flex flex-col justify-center items-center w-full h-full bg-primary text-xs p-4 rounded-md",children:s.jsx(O,{})});export{X as default};
