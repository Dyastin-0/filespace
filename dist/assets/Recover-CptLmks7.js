import{u as E,d as _,r as e,c as I,j as s,B as M,e as k}from"./index-BKNLTqy2.js";import{I as m}from"./Input-GOd7nCC5.js";import{S as x}from"./ShowPassword-DKbuD3M6.js";import{t as B}from"./regex-Bon46KuK.js";import{P as $}from"./ProgressBar-BmsTvvgm.js";import{H as q}from"./Helmet-fCbaTteU.js";const z=()=>{const h=E(),[g]=_(),i=e.useRef(null),[t,P]=e.useState({password:""}),c=g.get("t"),[r,S]=e.useState(""),[d,j]=e.useState(!1),[n,v]=e.useState({strength:0,color:"red",message:"Very weak"}),[w,b]=e.useState(!1),[u,y]=e.useState(!1),[p,f]=e.useState(!1),{toastError:o,toastInfo:N}=I();e.useEffect(()=>{i.current.focus()},[]),e.useEffect(()=>{j(r===t.password)},[r,t.password]),e.useEffect(()=>{v(B(t.password))},[t.password]);const R=async a=>{if(a.preventDefault(),!c)return o("Missing password reset token.");if(n.strength<25)return o("Password should at least be 'Good.'");if(!d)return o("Passwords do not match.");f(!0);try{const{data:l}=await k.post("/auth/recover",{t:c,newPassword:t.password});N(l.message),h("/sign-in")}catch(l){const C=l.response.data||"Failed to reset your password.";o(C)}finally{f(!1)}};return s.jsxs("div",{className:"flex flex-col p-4 justify-center items-center h-full w-full text-primary-foreground bg-primary rounded-xl",children:[s.jsx(q,{children:s.jsx("title",{children:"Password Reset"})}),s.jsxs("form",{className:"flex flex-col w-[250px] max-w-full p-4 text-xs text-primary-foreground border border-secondary-accent rounded-md",onSubmit:R,children:[s.jsx("h2",{className:"w-full text-center pb-4 text-lg font-bold",children:"Password Reset"}),s.jsxs("div",{className:"relative",children:[s.jsx(m,{ref:i,placeholder:"New Password",required:!0,id:"password",type:w?"text":"password",value:t.password,className:`${!d&&t.password?"shadow-[2px_2px_0_0] shadow-error":""}`,onChange:a=>P({...t,password:a.target.value})}),t.password&&s.jsx(x,{showPassword:w,setShowPassword:b})]}),s.jsx($,{value:n.strength,text:n.message,visible:t.password}),s.jsxs("div",{className:"relative",children:[s.jsx(m,{placeholder:"Confirm Password",required:!0,id:"confirm_password",type:u?"text":"password",value:r,className:`${!d&&r?"shadow-[2px_2px_0_0] shadow-danger":""}`,onChange:a=>S(a.target.value)}),r&&s.jsx(x,{showPassword:u,setShowPassword:y})]}),s.jsx(M,{type:"submit",disabled:p,text:`${p?"Resetting...":"Reset Password"}`})]})]})};export{z as default};
